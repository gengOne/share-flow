# ğŸ” é›†æˆéªŒè¯æ¸…å•

## å¿«é€ŸéªŒè¯ï¼ˆæ¨èï¼‰

**ä¸€é”®æµ‹è¯•:**
```bash
start-test.bat
```

è¿™ä¼šè‡ªåŠ¨ï¼š
1. âœ… æ£€æŸ¥ Rust ç¼–è¯‘
2. âœ… å¯åŠ¨ Rust æœåŠ¡
3. âœ… æ‰“å¼€æµ‹è¯•é¡µé¢

## æ‰‹åŠ¨éªŒè¯æ­¥éª¤

### Step 1: ç¼–è¯‘ Rust æœåŠ¡

```bash
cd rust-service
cargo build
```

**é¢„æœŸè¾“å‡º:**
```
Compiling rust-service v0.1.0
Finished dev profile [unoptimized + debuginfo] target(s) in X.XXs
```

âœ… ç¼–è¯‘æˆåŠŸï¼Œæ— é”™è¯¯
âš ï¸ å¯ä»¥æœ‰è­¦å‘Šï¼ˆunused functionsï¼‰

---

### Step 2: å¯åŠ¨ Rust æœåŠ¡

```bash
cargo run
```

**é¢„æœŸè¾“å‡º:**
```
Starting ShareFlow Service
  UDP Discovery: port 8080
  WebSocket API: ws://127.0.0.1:4000
Service is running. Waiting for events...
```

âœ… çœ‹åˆ° "WebSocket API: ws://127.0.0.1:4000"
âœ… æ²¡æœ‰é”™è¯¯ä¿¡æ¯
âœ… è¿›ç¨‹ä¿æŒè¿è¡Œ

---

### Step 3: æµ‹è¯• WebSocket è¿æ¥

**æ‰“å¼€æµ‹è¯•é¡µé¢:**
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•
start test-connection.html
```

æˆ–ç›´æ¥åŒå‡» `test-connection.html`

**åœ¨æµ‹è¯•é¡µé¢:**
1. ç‚¹å‡» "è¿æ¥" æŒ‰é’®
2. è§‚å¯ŸçŠ¶æ€å˜åŒ–

**é¢„æœŸç»“æœ:**
- âœ… çŠ¶æ€ä» "æœªè¿æ¥" â†’ "è¿æ¥ä¸­..." â†’ "å·²è¿æ¥"
- âœ… æ—¥å¿—æ˜¾ç¤º: `âœ“ WebSocket è¿æ¥æˆåŠŸ!`
- âœ… Rust ç»ˆç«¯æ˜¾ç¤º: `New WebSocket connection from: 127.0.0.1:xxxxx`

**æµ‹è¯•æ¶ˆæ¯æ”¶å‘:**
1. ç‚¹å‡» "å¼€å§‹å‘ç°è®¾å¤‡"
2. è§‚å¯Ÿæ—¥å¿—

**é¢„æœŸç»“æœ:**
- âœ… æ—¥å¿—æ˜¾ç¤º: `â†’ å‘é€æ¶ˆæ¯: startDiscovery`
- âœ… Rust ç»ˆç«¯æ˜¾ç¤º: `Frontend requested discovery start`

---

### Step 4: æµ‹è¯•å‰ç«¯åº”ç”¨

**å¯åŠ¨å‰ç«¯:**
```bash
# æ–°ç»ˆç«¯ï¼ˆä¿æŒ Rust æœåŠ¡è¿è¡Œï¼‰
npm run dev
```

**æ‰“å¼€æµè§ˆå™¨:**
- è®¿é—® http://localhost:3000
- æ‰“å¼€å¼€å‘è€…å·¥å…· (F12)

**é¢„æœŸç»“æœ:**
- âœ… æ§åˆ¶å°æ˜¾ç¤º: `[RealBackend] Connecting to Rust service at ws://127.0.0.1:4000`
- âœ… æ§åˆ¶å°æ˜¾ç¤º: `[RealBackend] Connected to Rust service`
- âœ… UI æ­£å¸¸æ˜¾ç¤ºï¼Œæ— é”™è¯¯
- âœ… ä¾§è¾¹æ æ˜¾ç¤º "LAN Active"

---

### Step 5: æµ‹è¯•è®¾å¤‡å‘ç°ï¼ˆå¯é€‰ï¼‰

**éœ€è¦ä¸¤å°è®¾å¤‡åœ¨åŒä¸€å±€åŸŸç½‘:**

**è®¾å¤‡ A:**
```bash
cd rust-service
cargo run
```

**è®¾å¤‡ B:**
```bash
cd rust-service
cargo run
```

**é¢„æœŸç»“æœ:**
- âœ… è®¾å¤‡ A æ˜¾ç¤º: `Discovered Peer: RustService (...) at 192.168.x.x:8080`
- âœ… è®¾å¤‡ B æ˜¾ç¤º: `Discovered Peer: RustService (...) at 192.168.x.x:8080`
- âœ… æµ‹è¯•é¡µé¢çš„è®¾å¤‡åˆ—è¡¨æ˜¾ç¤ºå¯¹æ–¹è®¾å¤‡

---

## æ•…éšœæ’æŸ¥

### âŒ Rust ç¼–è¯‘å¤±è´¥

**ç—‡çŠ¶:**
```
error: could not compile `rust-service`
```

**è§£å†³æ–¹æ¡ˆ:**
```bash
# æ›´æ–° Rust
rustup update

# æ¸…ç†å¹¶é‡æ–°ç¼–è¯‘
cargo clean
cargo build
```

---

### âŒ WebSocket è¿æ¥å¤±è´¥

**ç—‡çŠ¶:**
- æµ‹è¯•é¡µé¢æ˜¾ç¤º "æœªè¿æ¥"
- æ§åˆ¶å°é”™è¯¯: `WebSocket connection failed`

**æ£€æŸ¥æ¸…å•:**
1. âœ… Rust æœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œï¼Ÿ
2. âœ… ç«¯å£ 4000 æ˜¯å¦è¢«å ç”¨ï¼Ÿ
   ```bash
   netstat -ano | findstr :4000
   ```
3. âœ… é˜²ç«å¢™æ˜¯å¦é˜»æ­¢è¿æ¥ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ:**
```bash
# é‡å¯ Rust æœåŠ¡
# Ctrl+C åœæ­¢ï¼Œç„¶åé‡æ–°è¿è¡Œ
cargo run
```

---

### âŒ å‰ç«¯æ— æ³•è¿æ¥

**ç—‡çŠ¶:**
- æµè§ˆå™¨æ§åˆ¶å°: `[RealBackend] WebSocket error`
- ä¸æ–­é‡è¿

**æ£€æŸ¥æ¸…å•:**
1. âœ… Rust æœåŠ¡æ˜¯å¦è¿è¡Œï¼Ÿ
2. âœ… ä½¿ç”¨çš„æ˜¯ `realBackend` è¿˜æ˜¯ `mockBackend`ï¼Ÿ
   - æ£€æŸ¥ `services/backend.ts`

**è§£å†³æ–¹æ¡ˆ:**
```typescript
// services/backend.ts
// ç¡®ä¿ä½¿ç”¨ realBackend
export { backend } from './realBackend';
```

---

### âŒ æ‰¾ä¸åˆ°è®¾å¤‡

**ç—‡çŠ¶:**
- è®¾å¤‡åˆ—è¡¨ä¸ºç©º
- æ²¡æœ‰å‘ç°ä»»ä½•è®¾å¤‡

**æ£€æŸ¥æ¸…å•:**
1. âœ… ä¸¤å°è®¾å¤‡åœ¨åŒä¸€å±€åŸŸç½‘ï¼Ÿ
2. âœ… UDP ç«¯å£ 8080 æœªè¢«å ç”¨ï¼Ÿ
3. âœ… é˜²ç«å¢™å…è®¸ UDP å¹¿æ’­ï¼Ÿ
4. âœ… ä¸¤å°è®¾å¤‡éƒ½åœ¨è¿è¡Œ Rust æœåŠ¡ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ:**
```bash
# Windows é˜²ç«å¢™è§„åˆ™
netsh advfirewall firewall add rule name="ShareFlow UDP" dir=in action=allow protocol=UDP localport=8080
netsh advfirewall firewall add rule name="ShareFlow TCP" dir=in action=allow protocol=TCP localport=8080
```

---

## æ€§èƒ½éªŒè¯

### å»¶è¿Ÿæµ‹è¯•

**åœ¨æµ‹è¯•é¡µé¢:**
1. è¿æ¥æˆåŠŸå
2. ç‚¹å‡» "å¼€å§‹å‘ç°è®¾å¤‡"
3. è§‚å¯Ÿæ—¥å¿—æ—¶é—´æˆ³

**é¢„æœŸç»“æœ:**
- âœ… æ¶ˆæ¯å¾€è¿”æ—¶é—´ < 10ms
- âœ… æ— æ˜æ˜¾å»¶è¿Ÿ

### ç¨³å®šæ€§æµ‹è¯•

**é•¿æ—¶é—´è¿è¡Œ:**
1. ä¿æŒè¿æ¥ 5 åˆ†é’Ÿ
2. è§‚å¯Ÿæ˜¯å¦æ–­çº¿

**é¢„æœŸç»“æœ:**
- âœ… è¿æ¥ä¿æŒç¨³å®š
- âœ… æ— å†…å­˜æ³„æ¼
- âœ… æ— å¼‚å¸¸é”™è¯¯

---

## éªŒè¯å®Œæˆæ ‡å‡†

### å¿…é¡»é€šè¿‡ âœ…

- [ ] Rust æœåŠ¡å¯ä»¥ç¼–è¯‘
- [ ] Rust æœåŠ¡å¯ä»¥è¿è¡Œ
- [ ] WebSocket å¯ä»¥è¿æ¥
- [ ] æµ‹è¯•é¡µé¢æ˜¾ç¤º "å·²è¿æ¥"
- [ ] å¯ä»¥å‘é€å’Œæ¥æ”¶æ¶ˆæ¯
- [ ] å‰ç«¯åº”ç”¨æ— é”™è¯¯

### å¯é€‰é€šè¿‡ â­

- [ ] è®¾å¤‡å‘ç°åŠŸèƒ½æ­£å¸¸
- [ ] å¤šè®¾å¤‡äº’ç›¸å‘ç°
- [ ] è¿æ¥è¯·æ±‚æµç¨‹å®Œæ•´
- [ ] è¾“å…¥äº‹ä»¶å¯ä»¥å‘é€

---

## ä¸‹ä¸€æ­¥

éªŒè¯é€šè¿‡åï¼Œå¯ä»¥ç»§ç»­å¼€å‘ï¼š

1. **å®Œå–„è¿æ¥é€»è¾‘**
   - å®ç°çœŸå®çš„ TCP è¿æ¥
   - æ·»åŠ è¿æ¥çŠ¶æ€ç®¡ç†

2. **è¾“å…¥æ•è·**
   - é›†æˆ `rdev` åº“
   - å®ç°é”®ç›˜é¼ æ ‡æ•è·

3. **è¾“å…¥æ³¨å…¥**
   - å®ç°è¿œç¨‹è¾“å…¥æ¨¡æ‹Ÿ
   - ä¼˜åŒ–å»¶è¿Ÿå’Œæ€§èƒ½

4. **ç”¨æˆ·ä½“éªŒ**
   - æ·»åŠ è¿æ¥åŠ¨ç”»
   - æ”¹è¿›é”™è¯¯æç¤º
   - æ·»åŠ è®¾ç½®é¡µé¢

---

## è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. ğŸ“– æŸ¥çœ‹ [QUICKSTART.md](./QUICKSTART.md)
2. ğŸ“– æŸ¥çœ‹ [WEBSOCKET.md](./WEBSOCKET.md)
3. ğŸ” æ£€æŸ¥ Rust æœåŠ¡æ—¥å¿—
4. ğŸ” æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°
5. ğŸ§ª ä½¿ç”¨ `test-connection.html` éš”ç¦»é—®é¢˜

---

**æœ€åæ›´æ–°:** 2024-11-29
**çŠ¶æ€:** âœ… é›†æˆå®Œæˆï¼Œç­‰å¾…éªŒè¯
